#Module 1 - Managing Azure Subscriptions and Resources  
## Exploring Monitoring Capabilities in Azure 

__Azure Monitor__
![alt text](https://docs.microsoft.com/en-us/azure/azure-monitor/media/overview/overview.png)

![alt text](https://docs.microsoft.com/en-us/azure/azure-monitor/media/overview/metrics.png)


![alt text](https://docs.microsoft.com/en-us/azure/azure-monitor/media/overview/logs.png)


__Azure Monitor provides three main capabilities.__

- __Monitor and visualize metrics__. Metrics are numerical values available from Azure resources helping you understand the health, operation and performance of your system.

- __Query and analyze logs__. Logs are activity logs, diagnostic logs, and telemetry from monitoring solutions; analytics queries help with troubleshooting and visualizations.

- __Setup alerts and actions__. Alerts notify you of critical conditions and potentially take automated corrective actions based on triggers from metrics or logs.


__Data Types__

- __Application monitoring data__: Data about the performance and functionality of "*the code you have written*".

- __Guest OS monitoring data__: Data about "_the operating system_" on which your application is running.

- __Azure__
    - __Azure resource monitoring data__: Data about the operation of an Azure resource.

    - __Azure subscription monitoring data__: Data about the operation and management of an Azure subscription, as well as data about the health and operation of Azure itself.

    - __Azure tenant monitoring data__: Data about the operation of tenant-level Azure services, such as Azure Active Directory.

---
__Activity Log__
The Azure Activity Log is a subscription log that provides insight into subscription-level events that have occurred in Azure.

_With the Activity Log, you can determine the ‘what, who, and when’ for any write operations (PUT, POST, DELETE) taken on the resources in your subscription._

![alt text](https://openedx.microsoft.com/assets/courseware/v1/ce02dd3bc70644c739c728160039f737/asset-v1:Microsoft+AZ-300.1+2019_T2+type@asset+block/AZ103_Activity_Log.png)

>Activity logs are __kept for 90 days__. You can query for any range of dates, as long as the starting date isn't more than 90 days in the past. You can retrieve events from your Activity Log using the Azure portal, CLI, PowerShell cmdlets, and Azure Monitor REST API.

__Query the Activity Log__

![alt text](https://openedx.microsoft.com/assets/courseware/v1/343b6a9e24946d184ec766d9db599b6d/asset-v1:Microsoft+AZ-300.1+2019_T2+type@asset+block/AZ103_Query_the_Activity_Log.png)

__Event Categories__
The Activity Log provides several event categories. You may select one or more.

- __Administrative__. This category contains the record of all create, update, delete, and action operations performed through Resource Manager
    > "Who create VM"

- __Service Health__. This category contains the record of any service health incidents that have occurred in Azure.
    > "SQL Azure in SEA experiencing downtime"

- __Alert__. This category contains the record of all activations of Azure alerts.
    > “CPU % on myVM has been over 80 for the past 5 minutes”

- __Autoscale__. This category contains the record of any events related to the operation of the autoscale engine based on any autoscale settings you have defined in your subscription.
    > "An example of the type of event you would see in this category is “Autoscale scale up action failed”

- __Recommendation__. This category contains recommendation events from certain resource types, such as web sites and SQL servers. These events offer recommendations for how to better utilize your resources.

- __Security__. This category contains the record of any alerts generated by Azure Security Center.
    > “Suspicious double extension file executed”

- __Policy__ and Resource Health. These categories do not contain any events; they are reserved for future use.

---

__Azure Advisor__
Advisor is a personalized cloud consultant that helps you follow best practices to optimize your Azure deployments. 

![alt text](https://openedx.microsoft.com/assets/courseware/v1/507eebdf6040c8446498956646909c75/asset-v1:Microsoft+AZ-300.1+2019_T2+type@asset+block/AZ-100.1_Subscriptions_and_Resources_image33.png)

Advisor provides recommendations for:
- Virtual machines
- Availability sets
- Application gateways
- App Services
- SQL servers
- Redis Cache

---
__Azure Monitor Alerts__

![alt text](https://openedx.microsoft.com/assets/courseware/v1/0dd41365f0e26556352495ca1f9738fe/asset-v1:Microsoft+AZ-300.1+2019_T2+type@asset+block/AZ-100.1_Subscriptions_and_Resources_image34.png)


![alt text](https://openedx.microsoft.com/assets/courseware/v1/31de136f30794ed496cfe10976fc759f/asset-v1:Microsoft+AZ-300.1+2019_T2+type@asset+block/AZ103_Azure_Rules.png)

Alert rules are separated from __alerts__ and __the actions__ that are taken when an alert fires. The alert rule captures the target and criteria for alerting. The alert rule can be in an _"enabled"_ or a _"disabled"_ state. Alerts only fire when enabled. The key attributes of an alert rule are:

- __Target Resource__ – Defines the scope and signals available for alerting.
> A target can be any Azure resource e.g.:
> - Virtual machine
>- Storage account
>- Virtual machine scale set
>- Log Analytics workspace
>- Application Insights resource. 
>
>For certain resources (like Virtual Machines), you can specify multiple resources as the target of the alert rule.

__Signal__ – Signals are emitted by the target resource and can be of several types. Metric, Activity log, Application Insights, and Log.
__Criteria__ – Criteria is a combination of Signal and Logic applied on a Target resource.
>Example: 
> Percentage CPU > 70%; Server Response Time > 4 ms; and Result count of a log query > 100.

__Alert Name__ – A specific name for the alert rule configured by the user.
__Alert Description__ – A description for the alert rule configured by the user.
__Severity__ – The severity of the alert once the criteria specified in the alert rule is met. Severity can range from 0 to 4.
__Action__ – A specific action taken when the alert is fired. See the Action Groups topic coming up.
